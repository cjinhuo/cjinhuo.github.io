(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{415:function(t,s,a){"use strict";a.r(s);var r=a(4),e=Object(r.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[a("strong",[t._v("本文作者："),a("a",{attrs:{href:"https://github.com/cjinhuo",target:"_blank",rel:"noopener noreferrer"}},[t._v("cjinhuo"),a("OutboundLink")],1),t._v("，未经授权禁止转载。")])]),t._v(" "),a("h1",{attrs:{id:"概要"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概要"}},[t._v("#")]),t._v(" 概要")]),t._v(" "),a("p",[t._v("本文的主要目的是介绍一种可扩展性较好的SDK架构，让后续业务迭代的代码更清晰明朗。这种架构已经在开源监控SDK:"),a("a",{attrs:{href:"https://github.com/mitojs/mitojs",target:"_blank",rel:"noopener noreferrer"}},[t._v("mitojs"),a("OutboundLink")],1),t._v("实践，有兴趣的小伙伴可以去瞅瞅~")]),t._v(" "),a("p",[t._v("来到正文，本文分成三个部分")]),t._v(" "),a("ul",[a("li",[t._v("背景")]),t._v(" "),a("li",[t._v("SDK的架构与迭代")]),t._v(" "),a("li",[t._v("结尾")])]),t._v(" "),a("h1",{attrs:{id:"背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[t._v("#")]),t._v(" 背景")]),t._v(" "),a("p",[t._v("传统模式下，前端项目发到正式环境后就变成了一个黑盒子，所有报错信息只能通过用户使用时截图、口头描述发送到开发者，然后开发者来根据用户所描述的场景去模拟这个错误的产生，这效率特低，所以很多开源或收费的前端监控平台就应运而生，比如:")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/getsentry/sentry",target:"_blank",rel:"noopener noreferrer"}},[t._v("sentry"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/a597873885/webfunny_monitor",target:"_blank",rel:"noopener noreferrer"}},[t._v("webfunny"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.fundebug.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("fundebug"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.aliyun.com/product/arms",target:"_blank",rel:"noopener noreferrer"}},[t._v("阿里云前端监控(ARMS)"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("等等一些优秀的监控平台")]),t._v(" "),a("h2",{attrs:{id:"自研的优势"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自研的优势"}},[t._v("#")]),t._v(" 自研的优势")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("阿里云前端监控(ARMS)")]),t._v("和"),a("code",[t._v("fundebug")]),t._v("需要投入大量金钱来作为支持，而"),a("code",[t._v("webfunny")]),t._v("和"),a("code",[t._v("sentry")]),t._v("虽是可以用"),a("code",[t._v("docker")]),t._v("私有化部署，但由于其源代码没有开源，二次开发受限")]),t._v(" "),a("li",[t._v("可以将公司所有的SDK统一成一个，包括但不限于：埋点平台SDK、性能监控SDK、录屏SDK")]),t._v(" "),a("li",[t._v("可以无缝共享采集到的信息，比如错误信息可以和埋点信息联动，便可拿到更细的用户行为栈，更快的排查线上错误")]),t._v(" "),a("li",[t._v("可以设计更好的服务端结构，相同服务器的性能，不同的架构可以抗住不同的QPS")])]),t._v(" "),a("h2",{attrs:{id:"监控平台的组成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#监控平台的组成"}},[t._v("#")]),t._v(" 监控平台的组成")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ebf9ce746d034a209429a694655f1ffa~tplv-k3u1fbpfcp-zoom-1.image",alt:"整体流程"}})]),t._v(" "),a("h1",{attrs:{id:"sdk的架构与迭代"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sdk的架构与迭代"}},[t._v("#")]),t._v(" SDK的架构与迭代")]),t._v(" "),a("p",[t._v("前端监控的原理其实就那么几个，比如拦截http请求就是重写原生函数:fetch、XMLHttpRequest，监控代码错误：window.onerror，但SDK也是一个工程，是需要不断迭代追加功能的，所以良好的架构可以为后期迭代打下不错的地基")]),t._v(" "),a("h2",{attrs:{id:"monorepo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#monorepo"}},[t._v("#")]),t._v(" monorepo")]),t._v(" "),a("p",[t._v("借鉴了"),a("code",[t._v("sentry")]),t._v("和"),a("code",[t._v("vue-next")]),t._v("的代码目录结构，最终也是采用"),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Monorepo",target:"_blank",rel:"noopener noreferrer"}},[t._v("monorepo"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("它的优势：")]),t._v(" "),a("ol",[a("li",[t._v("分模块打包、分模块热更新、分包发布（提高开发体验）")]),t._v(" "),a("li",[t._v("抽离抽象类、工具类到某个包，代码结构清晰（降低耦合性，提高代码可读性）")])]),t._v(" "),a("h3",{attrs:{id:"包与包之间的关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#包与包之间的关系"}},[t._v("#")]),t._v(" 包与包之间的关系")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://files.catbox.moe/00of0w.png",alt:"包与包间的关系.png"}})]),t._v(" "),a("h3",{attrs:{id:"多包打包与发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多包打包与发布"}},[t._v("#")]),t._v(" 多包打包与发布")]),t._v(" "),a("p",[t._v("试用了"),a("a",{attrs:{href:"https://github.com/lerna/lerna",target:"_blank",rel:"noopener noreferrer"}},[t._v("lerna"),a("OutboundLink")],1),t._v("后，发现它的功能太多，我想要的只是一个打包和发布的功能，最终是用js脚步编写根据命令行的入参来调用"),a("code",[t._v("rollup")]),t._v("的"),a("code",[t._v("api")]),t._v("和"),a("code",[t._v("npm")]),t._v("的"),a("code",[t._v("api")]),t._v("来打包和发布，具体"),a("a",{attrs:{href:"https://github.com/mitojs/mitojs/blob/master/script/build.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("打包脚本"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"可插拔的插件思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可插拔的插件思路"}},[t._v("#")]),t._v(" 可插拔的插件思路")]),t._v(" "),a("p",[t._v("该思路是从"),a("a",{attrs:{href:"https://rollupjs.org/guide/en/#plugins-overview",target:"_blank",rel:"noopener noreferrer"}},[t._v("rollup"),a("OutboundLink")],1),t._v("和监控开源库"),a("a",{attrs:{href:"https://github.com/dora-projects/dora/tree/master/packages/browser/src/plugins",target:"_blank",rel:"noopener noreferrer"}},[t._v("dora"),a("OutboundLink")],1),t._v("中借鉴。")]),t._v(" "),a("p",[t._v("我们需要监控:")]),t._v(" "),a("ul",[a("li",[t._v("xhr")]),t._v(" "),a("li",[t._v("fetch")]),t._v(" "),a("li",[t._v("hashroute")]),t._v(" "),a("li",[t._v("historyroute")]),t._v(" "),a("li",[t._v("error\n...等等")])]),t._v(" "),a("h3",{attrs:{id:"传统模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#传统模式"}},[t._v("#")]),t._v(" 传统模式")]),t._v(" "),a("ol",[a("li",[t._v("重写xhr")]),t._v(" "),a("li",[t._v("在重写的过程中拿到想要的数据")]),t._v(" "),a("li",[t._v("通过发布订阅回传")]),t._v(" "),a("li",[t._v("在订阅中心中拿到数据，并处理")])]),t._v(" "),a("p",[t._v("如果没有规范的约束，每个重写的过程都会变的杂乱无章，回传数据和处理数据可能到处都是。")]),t._v(" "),a("p",[t._v("如果我们借鉴了插件模式后，会变成什么样呢？")]),t._v(" "),a("h3",{attrs:{id:"插件模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#插件模式"}},[t._v("#")]),t._v(" 插件模式")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BasePluginType")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("T")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EventTypes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" EventTypes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("C")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BaseClientType")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" BaseClientType"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 事件枚举")]),t._v("\n  name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("T")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监控事件，并在该事件中用notify通知订阅中心")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("monitor")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("C")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("notify")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("T")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在monitor中触发数据并将数据传入当前函数，拿到数据做数据格式转换")]),t._v("\n  transform"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("C")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" collectedData"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" any\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 拿到转换后的数据进行breadcrumb、report等等操作")]),t._v("\n  consumer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("C")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" transformedData"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://files.catbox.moe/tti6z1.png",alt:"baseplugin.png"}})]),t._v(" "),a("p",[t._v("这时就会有人说了，如果我的业务比这复杂多了，那这个架构还能撑住吗？是可以的，将上面插件中的3个hooks:"),a("code",[t._v("monitor、transform、consumer")]),t._v("分成更多hooks，可以是5个也可以是10个，只要你分的颗粒度足够细，且完全按照这些hooks的对应功能来编写代码，不管你的项目代码有多几十万行，你的代码层次结构都是很清晰的")]),t._v(" "),a("h3",{attrs:{id:"举个🌰：监听unhandlerejection的插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#举个🌰：监听unhandlerejection的插件"}},[t._v("#")]),t._v(" 举个🌰：监听unhandlerejection的插件")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://files.catbox.moe/86e8gp.png",alt:"unhandlerejectionPlugin.png"}})]),t._v(" "),a("h3",{attrs:{id:"插件实际在代码中的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#插件实际在代码中的使用"}},[t._v("#")]),t._v(" 插件实际在代码中的使用")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://files.catbox.moe/8k4tdh.png",alt:"browserClient"}})]),t._v(" "),a("h3",{attrs:{id:"在vue3使用-mitojs-vue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在vue3使用-mitojs-vue"}},[t._v("#")]),t._v(" 在Vue3使用@mitojs/vue")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// main.ts")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" createApp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" App "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./App.vue'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" init "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@mitojs/browser"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" vuePlugin "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@mitojs/vue"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createApp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("App"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" MitoInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  vue"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  dsn"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://test.com/yourInterface'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  maxBreadcrumbs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("vuePlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])]),a("p",[t._v("可以去"),a("a",{attrs:{href:"https://mitojs.github.io/vue3-sdk-demo/#/page-one",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue3 Demo"),a("OutboundLink")],1),t._v("体验一下sdk收集的数据，更多信息可以访问"),a("a",{attrs:{href:"https://mitojs.github.io/mito-doc/#/sdk/guide/vue",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue3 接入指南"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"mitojs-core"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mitojs-core"}},[t._v("#")]),t._v(" @mitojs/core")]),t._v(" "),a("p",[t._v("上面讲完插件是构成整个"),a("code",[t._v("SDK")]),t._v("的主要链路，现在讲下最基本的一些工具类，来串联这些插件，由于需要支持多个端，每个端需要监听的事件、上报方式、可配置项的是不同的，所以需要抽离多个抽象类，方便扩展。如下是"),a("a",{attrs:{href:"https://github.com/mitojs/mitojs/tree/master/packages/core",target:"_blank",rel:"noopener noreferrer"}},[t._v("@mitojs/core"),a("OutboundLink")],1),t._v("的整体思维导图")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://files.catbox.moe/rtv75h.png",alt:"core.png"}})]),t._v(" "),a("h2",{attrs:{id:"浏览器的整体思维导图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的整体思维导图"}},[t._v("#")]),t._v(" 浏览器的整体思维导图")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://files.catbox.moe/g57hci.png",alt:"browser-architecture"}})]),t._v(" "),a("h2",{attrs:{id:"微信小程序的整体思维导图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#微信小程序的整体思维导图"}},[t._v("#")]),t._v(" 微信小程序的整体思维导图")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://files.catbox.moe/bsl1h2.png",alt:"wx-mini-architecture"}})]),t._v(" "),a("h2",{attrs:{id:"可迭代性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可迭代性"}},[t._v("#")]),t._v(" 可迭代性")]),t._v(" "),a("p",[t._v("后续如果有人想"),a("code",[t._v("pull request")]),t._v(" "),a("code",[t._v("node监控")]),t._v("或"),a("code",[t._v("其他小程序的监控")]),t._v("，只要按照这个插件模式开发，可迭代性便会大大提高")]),t._v(" "),a("h1",{attrs:{id:"结尾"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结尾"}},[t._v("#")]),t._v(" 结尾")]),t._v(" "),a("h2",{attrs:{id:"🤔-小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🤔-小结"}},[t._v("#")]),t._v(" 🤔 小结")]),t._v(" "),a("p",[t._v("该架构的思想可适用于任何SDK，不同SDK中对应插件的个数和作用不同。总而言之，把一个大功能分隔成几个小功能区域，在指定的区域写指定功能的代码，让代码逻辑有规律可循。")]),t._v(" "),a("p",[t._v("下一篇「监控SDK手摸手Teach-实现篇」会讲具体在插件代码的编写，敬请期待~")]),t._v(" "),a("h2",{attrs:{id:"🧐-开源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🧐-开源"}},[t._v("#")]),t._v(" 🧐 开源")]),t._v(" "),a("p",[t._v("github仓库"),a("a",{attrs:{href:"https://github.com/mitojs/mitojs",target:"_blank",rel:"noopener noreferrer"}},[t._v("mitojs"),a("OutboundLink")],1),t._v("，新SDK重构后，包的体积更小、代码架构更清晰，耦合性更低，文档："),a("a",{attrs:{href:"https://mitojs.github.io/mito-doc/#/sdk/guide/introduction",target:"_blank",rel:"noopener noreferrer"}},[t._v("mitojs文档"),a("OutboundLink")],1),t._v("，目前有部分人在用"),a("a",{attrs:{href:"https://github.com/mitojs/mitojs",target:"_blank",rel:"noopener noreferrer"}},[t._v("mitojs"),a("OutboundLink")],1),t._v("在做自己的监控平台或者埋点相关业务，如果你感兴趣可以，不妨过来瞅瞅 😘")]),t._v(" "),a("h2",{attrs:{id:"📞-联系-内推"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#📞-联系-内推"}},[t._v("#")]),t._v(" 📞 联系&内推")]),t._v(" "),a("p",[t._v("字节架构前端大量招人，内推可帮助修改简历和实时查询面试进度，欢迎砸简历到我的"),a("strong",[t._v("邮箱:chenjinhuo@bytedance.com")])]),t._v(" "),a("p",[t._v("如果你对字节架构前端、错误监控、埋点感兴趣、也直接联系我的"),a("strong",[t._v("微信:cjinhuo")])]),t._v(" "),a("p",[a("strong",[t._v("Have A Good Day!!!")])])])}),[],!1,null,null,null);s.default=e.exports}}]);